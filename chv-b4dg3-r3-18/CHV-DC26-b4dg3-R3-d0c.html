<!DOCTYPE html>
<html>
<head>
<title>DEFCON26 CarHackingVillage (CHV) Badge Reverse Engineering (RE) Guide</title>
</head>
<body>
<img src="assets/badge_long.jpg" width="800"/>
<h3>Sept. 2, 2018</h3>
<h4><a href="assets/music_tonight.png">Music: Animal Collective</a></h4> 
<p>
<b>[1:50am]:</b> Great, first thing's first. Install [Ruby+Devkit] so I can actually compile all the Jekyll shit so the post actually shows up on the main page.<br/>
<a href="https://rubyinstaller.org/downloads/">Go ahead, you can play along.</a><br/>
<br/>
<b>[1:54am]:</b> While downloading Ruby, I checked out the license in the badge's SDK from the manufacturer's website. <a href="assets/Specialized Solutions LLC License Agreement.txt">You can read it here.</a> Any lawyer out there who can decode if this is a good thing or bad thing.. seems very restrictive to my untrained eyes.<br/>
<br/>
<b>[2:00am]:</b> Wife came to tell me to get to bed. Better get to bed! But first, <a href="https://jekyllrb.com/docs/installation/windows/">I'm installing Jekyll finally after following these easy instructions.</a> Cool.<br/>
<br/>
<b>[9:00am]:</b> Well, now I know why I never write blogs. This is supposed to be on the CHV badge, but I haven't even successfully created a new post yet. I forgot to mention that "jekyll build" puked on "é" when I ran it last night.<br/>
<img src="assets/andre.png"> < -- It doesn't like the fancy-ass 'e'<br/>
<img src="assets/jekyll_error.png"><br/>
After a quick fix (set 'fancy-ass e' to 'e') the "jekyll build" was satisfied, but my post still isn't showing up on my site after pushing the gh-pages branch. I wonder if I didn't create a necessary link somwhere....<br/>
<br/>
<b>[10:14am]:</b> Okay, I watched <a href="https://www.youtube.com/watch?v=pxua_1vyFck&index=4&list=PLLAZ4kZ9dFpOPV5C5Ay0pHaa0RJFhcmcB">some Youtubez</a> and <a href="https://help.github.com/articles/setting-up-your-github-pages-site-locally-with-jekyll/">poked around some docs</a>. While I was at it, I renewed my domain with my DNS provider and configured HTTPS. It was easy, and I think the folks over at <a href="https://letsencrypt.org/">Let's Encrypt!</a>have something to do with it. Huge shout out!!! w00t w00t!! <br/>
Back to the Jekyll issue... I am thinking it's a build problem so I need to build it locally with something like "bundle exec jekyll serve".<br/>
<br/>
<b>[12:39pm]:</b> Time flies when you're having fun! /sarcasm. Okay so maybe I learned a few things, but I haven't gotten very far on my actual goal of reverse engineering this badge. I have figured out how this Jekyll shit works. Things mostly were broken just becuase they were old. I used jekyll to create a new test website from scratch. Then I brought in the post I am working on to see if it would render there, and voila! It did. So I copied over the newer Jekyll files like _config.yml and index.md. Then reorganized things. Messed with the 404.html (Check it out!: <a href="/404.html">404 ERROR!</a>), committed my paperclips and gum website, and pushed it up to gh-pages.<br/>

<h4> ENOUGH WITH THE ADMIN!!! TIME TO HACK!</h4>

<img src="assets/masterrace.gif"/><br/>
<br/>
I took some pics! The badge comes with an OBD-II connector for plugging directly into an internal combustion engine vehicle. You can find the connector under your steering wheel in most vehicles. <br/>
<img src="assets/badge_obdii.jpg" width="250"/>
<br/>
I noticed it uses one of NXP's S32K series MCUs. That's great because I am using a variant of that chip at work! The exact number is: <b><i>FS32K148HFVLQ</b></i>.<br/> I also looked up each chip and marked the following image to make life easier. <br/>
<img src="assets/badge_txrx_markup.jpg" width="400"/> <br/>
<img src="assets/badge_mcu_markup.jpg" width="500"/> <br/>
<br/>
<b>[2:04pm]:</b> The pictures are uploaded and marked. I will come back with a table of each component with links to the supplier's website. <br/>

</p>


<!-- <table border=1>
<tr>
    <th>Original Image</th>
    <th>Approximation</th>
    <th>Learning Curve</th>
    <th>3D Parameter Graph</th>
</tr>
<tr>
    <td>
        75&times;75 pixels<br>
        <img src="assets/images/im_mage.jpg"><br>
        <br><br>
    </td>
    <td>
        <img src="assets/approx/im_mage-0.png"><br>
        P=100 N=8 K=2<br>
        <img src="assets/APNGs/bestMage_500000.png"><br>E=500,000<br>Fmax=1.44365<br>
        <img src="assets/approx/im_mage-final.png">
    </td>
    <td>
        <img src="assets/charts/fitness_curve_mage.png">
    </td>
    <td>
        <img width=400 height=400 src="assets/charts/3d_surface_mage.jpg"><br>
        For E=25,000, N=8 & K=2 gave the best fitness, F=1.09601
    </td>
</tr>
<tr>
    <td>
        96&times;96 pixels<br>
        <img src="assets/images/im_darwin.jpg"><br>
        <br><br>
    </td>
    <td>
        <img src="assets/approx/im_darwin-0.png"><br>
        P=100, N=1, K=2<br>
        <img src="assets/APNGs/bestDarwin_500000.png"><br>
        E=500,000<br>
        Fmax=1.22866<br>
        <img src="assets/approx/im_darwin-final.png">
    </td>
    <td>
        <img src="assets/charts/fitness_curve_darwin.png">
    </td>
    <td>
        <img width=400 height=400 src="assets/charts/3d_surface_darwin.jpg"><br>
        For E=25,000, N=1 & K=2 gave the best fitness, F=0.96739
    </td>
</tr>
<tr>
    <td>
        128&times;128 pixels<br>
        <img src="assets/images/im_mona_lisa.jpg"><br>
        <br><br>
    </td>
    <td>
        <img src="assets/approx/im_mona_lisa-0.png"><br>
        P=100, N=1, K=2<br>
        <img src="assets/APNGs/bestMona_500000.png"><br>
        E=500,000<br>
        Fmax=1.23490<br>
        <img src="assets/approx/im_mona_lisa-final.png">
    </td>
    <td>
        <img src="assets/charts/fitness_curve_mona_lisa.png">
    </td>
    <td>
        <img width=400 height=400 src="assets/charts/3d_surface_mona_lisa.jpg"><br>
        For E=25,000, N=1 & K=2 gave the best fitness, F=0.99675
    </td>
</tr>
<tr>
    <td>
        150&times;150 pixels<br>
        <img src="assets/images/im_me.png"><br>
        <br><br>
    </td>
    <td>
        <img src="assets/approx/im_me-0.png"><br>
        P=100, N=1, K=2<br>
        <img src="assets/APNGs/bestMe_500000.png"><br>
        E=500,000<br>
        Fmax=1.15011<br>
        <img src="assets/approx/im_me-final.png">
    </td>
    <td>
        <img src="assets/charts/fitness_curve_me.png">
    </td>
    <td>
        <img width=400 height=400 src="assets/charts/3d_surface_me.jpg"><br>
        For E=25,000, N=1 & K=2 gave the best fitness, F=0.93654
    </td>
</tr>
<tr>
    <td>
        256&times;256 pixels<br>
        <img src="assets/images/im_majoras.jpg"><br>
        <br><br>
    </td>
    <td>
        <img src="assets/approx/im_majoras-0.png"><br>
        P=100, N=1, K=8<br>
        <img src="assets/APNGs/bestMajoras_500000.png"><br>
        E=500,000<br>
        Fmax=0.76837<br>
        <img src="assets/approx/im_majoras-final.png">
    </td>
    <td>
        <img src="assets/charts/fitness_curve_majoras.png">
    </td>
    <td>
        <img width=400 height=400 src="assets/charts/3d_surface_majoras.jpg"><br>
        For E=25,000, N=1 & K=8 gave the best fitness, F=0.61368
    </td>
</tr>
</table>
<br>
<hr>
<p>
Generally, if we take the mean average fitness of all 5 images parameterized by N and K up to 25,000 effort, we can see that the best overall value for (N,K) is (1, 1) with avg fitness 0.9171.<br>
<center><img width=400 height=400 src="assets/charts/3d_surface_combined_avg.jpg"></center><br>
</p>
<hr>
<p>
Mutations used:
<ul><li>10% chance to mutate <i>color</i> and <i>shape</i> of up to 10% of all polygons in genome.</li>
<li>10% chance to replace a polygon in the genome with a random triangle.</li>
<li>20% chance to swap the order of two polygons which are in adjacent in the genome.</li>
<li>20% chance to mutate an existing polygon's <i>color</i> and <i>shape</i>.</li>
<li>20% chance to mutate an existing polygon's <i>color</i>. </li>
<li>20% chance to mutate an existing polygon's <i>shape</i>. </li>
</ul>

<i>Shape Mutation:</i>
<ul><li>With 1/3 probability, remove a vertex.</li>
<li>With 1/3 probability, add a vertex close to an edge.</li>
        - If the slope of the edge wass undefined, the y component was chosen at the midpoint, and the x component was chosen with a Gaussian distribution w/ mean midpoint_x and stdev of 10% of total length of the edge. <br>
        - If the slope of the edge was 0, the x component was chosen at the midpoint, and the y component was chosen with a Gaussian distribution w/ mean midpoint_y and stdev of 10% total length of the edge.<br>
        - Otherwise, the x component was chosen uniformly between x_min and x_max of the edge while the y component was chosen uniformly between y_min and y_max of the edge.
<li>With 1/3 probability, move a vertex slightly.</li>
        - A Gaussian distribution w/ mean 0 and stdev 5 pixels was added to the x component and y component of the vertex.
</ul>

<i>Color Mutation:</i>
<ul><li>Mutate each of the polygon's R,G,B,A values:</li>
<ul><li>With 1/2 probability add 'val' chosen with uniform distribution in set {0, 5, 10, 20, 30}</li>
<li>With 1/2 probability subtract 'val' chosen with uniform distribution in set {0, 5, 10, 20, 30}</li>
</ul></ul>

<p>
Random triangles were created by picking a point on the image with uniform distribution, 
then adding a Gaussian distribution of mean 0 and stdev 20% of the image width to 
the initial point's x coordinate and adding a Gaussian distribution of mean 0 and stdev 20% 
image height to the initial point's y coordinate to obtain the second and third vertices.
Random colors were picked using uniform distribution over the RGB color space.
</p>
<p>
Parents were selected from an array of individuals sorted in decreasing order of fitness. The first parent was chosen
using the index <code>abs(random.gauss(0, 0.1*N))</code>. Then, the first parent was removed from possible parent choices,
and the second parent was chosen using <code>abs(random.gauss(0, 0.1*N))</code>. This made the more fit individuals
more likely to be chosen for crossover. Once the individuals were chosen, the number of polygons to take from the first parent was
chosen uniformly using <code>random.randint(0, P).</code> 
</p>
-->
</body>
</html>
